"0",""
"0","library(ggplot2)"
"0",""
"0",""
"0","col_week3 <- ""#FEE123""  # UO Yellow"
"0","col_week5 <- ""#154733""  # UO Dark Green"
"0",""
"0",""
"0","base_family <- ""Times"""
"0",""
"0",""
"0","cut_begin_min <- 7"
"0","cut_begin_max <- 10"
"0","cut_inter_max <- 16"
"0","rubric_max    <- 21"
"0",""
"0",""
"0","raw <- read.csv(""verbal_scores.csv"", stringsAsFactors = FALSE, check.names = FALSE)"
"0","ln  <- tolower(names(raw))"
"0",""
"0",""
"0","to_long <- function(df, part_col, week_col, score_col) {"
"0","  out <- data.frame("
"0","    Participant = as.character(df[[part_col]]),"
"0","    WeekLabel   = as.character(df[[week_col]]),"
"0","    TotalScore  = suppressWarnings(as.numeric(df[[score_col]])),"
"0","    stringsAsFactors = FALSE"
"0","  )"
"0","  out"
"0","}"
"0",""
"0","p_idx <- which(ln %in% c(""participant"",""participant_id"",""name"",""label"",""id""))"
"0","w_idx <- which(ln %in% c(""week"",""week_label"",""timepoint"",""time_point"",""session""))"
"0","s_idx <- which(ln %in% c(""totalscore"",""total_score"",""score"",""total"",""points"",""rubric_total""))"
"0",""
"0","if (length(p_idx) >= 1 && length(w_idx) >= 1 && length(s_idx) >= 1) {"
"0","  long <- to_long(raw, p_idx[1], w_idx[1], s_idx[1])"
"0",""
"0","} else {"
"0",""
"0","  w3_idx <- which(ln %in% c(""week3"",""week_3"",""w3"",""week 3"",""wk3""))"
"0","  w5_idx <- which(ln %in% c(""week5"",""week_5"",""w5"",""week 5"",""wk5""))"
"0","  if (length(p_idx) >= 1 && length(w3_idx) >= 1 && length(w5_idx) >= 1) {"
"0","    part <- as.character(raw[[p_idx[1]]])"
"0","    week3 <- suppressWarnings(as.numeric(raw[[w3_idx[1]]]))"
"0","    week5 <- suppressWarnings(as.numeric(raw[[w5_idx[1]]]))"
"0","    long <- rbind("
"0","      data.frame(Participant = part, WeekLabel = ""Week 3"", TotalScore = week3, stringsAsFactors = FALSE),"
"0","      data.frame(Participant = part, WeekLabel = ""Week 5"", TotalScore = week5, stringsAsFactors = FALSE)"
"0","    )"
"0","  } else {"
"0","    stop(""Cannot detect columns. Use either LONG format (Participant, Week/Timepoint, TotalScore) or WIDE format (Participant, Week3, Week5)."")"
"0","  }"
"0","}"
"0",""
"0",""
"0","norm_week <- function(x) {"
"0","  xl <- tolower(trimws(x))"
"0","  xl <- gsub(""_"", "" "", xl)"
"0","  ifelse(grepl(""5$"", xl) | grepl(""week 5|wk5|w5"", xl), ""Week 5"","
"0","         ifelse(grepl(""3$"", xl) | grepl(""week 3|wk3|w3"", xl), ""Week 3"", x))"
"0","}"
"0","long$WeekLabel <- norm_week(long$WeekLabel)"
"0",""
"0",""
"0","long <- long[long$WeekLabel %in% c(""Week 3"",""Week 5""), , drop = FALSE]"
"0",""
"0",""
"0","long$Participant <- factor(long$Participant, levels = unique(long$Participant))"
"0",""
"0","long$WeekLabel   <- factor(long$WeekLabel, levels = c(""Week 3"",""Week 5""))"
"0",""
"0",""
"0","band_df <- data.frame("
"0","  y_min = c(cut_begin_min, cut_begin_max,       cut_inter_max),"
"0","  y_max = c(cut_begin_max, cut_inter_max,       rubric_max),"
"0","  label = c(""Beginner (7–10)"", ""Intermediate (11–16)"", ""Advanced (17–21)"")"
"0",")"
"0",""
