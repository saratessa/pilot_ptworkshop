"0","library(ggplot2)"
"0","library(dplyr)"
"0","library(readr)"
"0","library(forcats)"
"0","library(scales)"
"0",""
"0","dat <- read_csv(""feedback_3pt_tidy.csv"", show_col_types = FALSE) %>%"
"0","  filter(!is.na(value_3pt))"
"0",""
"0",""
"0","dat$response_3pt <- factor("
"0","  dat$value_3pt,"
"0","  levels = c(1, 2, 3),"
"0","  labels = c(""Negative (1)"", ""Neutral (2)"", ""Positive (3)"")"
"0",")"
"0",""
"0",""
"0","plot_dat <- dat %>%"
"0","  group_by(group, question, response_3pt) %>%"
"0","  summarise(n = n(), .groups = ""drop_last"") %>%"
"0","  mutate(prop = n / sum(n)) %>%"
"0","  ungroup()"
"0",""
"0",""
"0","base_font <- ""serif""      "
"0","uo_green  <- ""#154733""    "
"0","uo_yellow <- ""#FEE123""     "
"0","uo_gray   <- ""#9CA3AF""     "
"0",""
"0",""
"0","make_group_plot <- function(g) {"
"0","  ggplot("
"0","    plot_dat %>% filter(group == g),"
"0","    aes("
"0","      x = fct_reorder("
"0","        question,"
"0","        prop,"
"0","        .fun = function(x) -sum(x[response_3pt == ""Positive (3)""], na.rm = TRUE)"
"0","      ),"
"0","      y = prop,"
"0","      fill = response_3pt"
"0","    )"
"0","  ) +"
"0","    geom_col(width = 0.7) +"
"0","    coord_flip() +"
"0","    scale_fill_manual("
"0","      values = c("
"0","        ""Negative (1)"" = uo_gray,"
"0","        ""Neutral (2)""  = uo_yellow,"
"0","        ""Positive (3)"" = uo_green"
"0","      )"
"0","    ) +"
"0","    scale_y_continuous(labels = percent_format(accuracy = 1)) +"
"0","    labs("
"0","      title = paste0(g, "" (3-point scale)""),"
"0","      x = NULL,"
"0","      y = ""Proportion of responses"","
"0","      fill = ""Response"""
"0","    ) +"
"0","    theme_minimal(base_family = base_font, base_size = 13) +"
"0","theme("
"0","  legend.position = ""right"","
"0","  panel.grid.major.y = element_blank(),"
"0","  panel.grid.minor = element_blank(),"
"0","  plot.title = element_text(face = ""bold""),"
"0","  axis.text.y = element_text(color = ""black"", size = 13)  "
"0",")"
"0","}"
"0",""
"0",""
"0","p_components <- make_group_plot(""Components"")"
"0","p_impact     <- make_group_plot(""Impact"")"
"0",""
"0",""
"0","print(p_components)"
