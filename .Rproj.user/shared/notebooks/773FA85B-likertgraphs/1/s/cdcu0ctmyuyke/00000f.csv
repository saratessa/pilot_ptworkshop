"0","suppressPackageStartupMessages({"
"0","  library(tidyverse)  "
"0","  library(scales)"
"0","})"
"0",""
"0",""
"0","dat_raw <- readr::read_csv("
"0","  ""feedback.csv"","
"0","  col_types = readr::cols(.default = readr::col_character())"
"0",")"
"0",""
"0","dat <- dat_raw %>%"
"0","  filter(!if_any(everything(), ~ stringr::str_detect(coalesce(.x, """"), fixed('{""ImportId""'))))"
"0",""
"0",""
"0","present <- c("
"0","  recorded_lessons_clarity = ""How clear and understandable were the recorded lessons?"","
"0","  guided_notes_helpful     = ""Did you find the guided notes helpful in following along with the recorded lessons?"","
"0","  recorded_prepared_quiz   = ""Did the recorded lessons prepare you for the quiz content?"","
"0","  one_pager_useful         = ""How useful was the One-Pager Review?"","
"0","  live_coaching_understand = ""How effective was the live coaching in helping you understand the content?"","
"0","  live_coaching_fluency    = ""How effective was the live coaching in helping you improve your fluency?"","
"0","  confidence_apply         = ""How confident are you in applying what you learned from this workshop series?"","
"0","  used_pt_real_life        = ""Have you used any of the Precision Teaching (PT) methods from this workshop in your real-life work?"","
"0","  likely_use_pt            = ""How likely are you to use any of the Precision Teaching (PT) methods from this workshop in your current or future work?"","
"0","  overall_satisfaction     = ""How satisfied were you with the workshop overall?"","
"0","  recommend_workshop       = ""Would you recommend this workshop to others?"""
"0",")"
"0",""
"0","pretty_label <- c("
"0","  recorded_lessons_clarity = ""Recorded lessons were clear"","
"0","  guided_notes_helpful     = ""Guided notes were helpful"","
"0","  recorded_prepared_quiz   = ""Recorded lessons prepared for quiz"","
"0","  one_pager_useful         = ""One-Pager was useful"","
"0","  live_coaching_understand = ""Live coaching improved understanding"","
"0","  live_coaching_fluency    = ""Live coaching improved fluency"","
"0","  confidence_apply         = ""Confident applying what was learned"","
"0","  used_pt_real_life        = ""Used PT methods in real work"","
"0","  likely_use_pt            = ""Likely to use PT"","
"0","  overall_satisfaction     = ""Overall satisfaction"","
"0","  recommend_workshop       = ""Recommend to others"""
"0",")"
"0",""
"0",""
"0","uo <- list("
"0","  green_oregon     = ""#154733"",  # very positive"
"0","  green_dark       = ""#006748"","
"0","  yellow_lightning = ""#FEE123"","
"0","  gold_yellow      = ""#FDD023"",  # neutral"
"0","  black            = ""#000000"","
"0","  gray_dark        = ""#5E6A71"",  # very negative"
"0","  gray_light       = ""#D0D3D4""   # somewhat negative / (your request) somewhat positive"
"0",")"
"0",""
"0","bucket_levels <- c(""Very negative"",""Somewhat negative"",""Neutral"",""Somewhat positive"",""Very positive"")"
"0",""
"0","bucket_colors <- c(uo$gray_dark, uo$gray_light, uo$gold_yellow, uo$gray_light, uo$green_oregon)"
"0","names(bucket_colors) <- bucket_levels"
"0",""
"0",""
"0","theme_uo <- theme_minimal(base_size = 12, base_family = ""Times New Roman"") +"
"0","  theme("
"0","    text               = element_text(family = ""Times New Roman""),"
"0","    panel.grid.major.y = element_blank(),"
"0","    panel.grid.minor   = element_blank(),"
"0","    axis.text          = element_text(color = uo$gray_dark),"
"0","    axis.text.y        = element_text(color = uo$black),     # left axis in black"
"0","    axis.title         = element_text(color = uo$gray_dark),"
"0","    plot.title         = element_text(face = ""bold"", size = 14, margin = margin(b = 6), color = uo$black),"
"0","    plot.caption       = element_text(size = 9, color = uo$gray_dark),"
"0","    legend.position    = ""bottom"","
"0","    legend.box         = ""vertical"","
"0","    legend.title       = element_text(face = ""bold"", color = uo$black)"
"0","  )"
"0",""
"0",""
"0","clean_ans <- function(x) {"
"0","  x %>%"
"0","    stringr::str_trim() %>%"
"0","    stringr::str_replace(""^\\s*\\d+\\s*[-â€“:]\\s*"", """") %>%   # drop ""4 - """
"0","    stringr::str_replace(""\\s*\\(?\\d+\\)?\\s*$"", """") %>%    # drop ""(4)"" / trailing numbers"
"0","    stringr::str_squish()"
"0","}"
"0","lc <- function(x) stringr::str_to_lower(x)"
"0",""
"0",""
"0","map_bucket <- function(ans) {"
"0","  a <- lc(ans)"
"0",""
"0","  very_neg <- c("
"0","    ""extremely unclear"", ""not effective at all"", ""not at all useful"", ""not at all helpful"","
"0","    ""not at all confident"", ""not likely"", ""^no$"", ""^not at all$"", ""extremely dissatisfied"""
"0","  )"
"0","  some_neg <- c("
"0","    ""somewhat unclear"", ""slightly effective"", ""slightly useful"", ""slightly helpful"","
"0","    ""^rarely$"", ""somewhat dissatisfied"""
"0","  )"
"0","  neutral <- c("
"0","    ""neither clear nor unclear"", ""moderately effective"", ""moderately useful"", ""moderately helpful"","
"0","    ""^neutral$"", ""^somewhat$"", ""neither satisfied nor dissatisfied"", ""^maybe$"""
"0","  )"
"0","  some_pos <- c("
"0","    ""somewhat clear"", ""very effective"", ""very useful"", ""very helpful"","
"0","    ""somewhat confident"", ""^likely$"", ""somewhat satisfied"""
"0","  )"
"0","  very_pos <- c("
"0","    ""extremely clear"", ""extremely effective"", ""extremely useful"", ""extremely helpful"","
"0","    ""very confident"", ""very likely"", ""^yes$"", ""extremely satisfied"""
"0","  )"
"0",""
"0","  case_when("
"0","    stringr::str_detect(a, paste(very_neg, collapse = ""|"")) ~ ""Very negative"","
"0","    stringr::str_detect(a, paste(some_neg, collapse = ""|"")) ~ ""Somewhat negative"","
"0","    stringr::str_detect(a, paste(neutral,  collapse = ""|"")) ~ ""Neutral"","
"0","    stringr::str_detect(a, paste(some_pos, collapse = ""|"")) ~ ""Somewhat positive"","
"0","    stringr::str_detect(a, paste(very_pos, collapse = ""|"")) ~ ""Very positive"","
"0","    TRUE ~ NA_character_   "
"0","  )"
"0","}"
"0",""
"0",""
"0","panel_df <- function(items) {"
"0","  items <- items[items %in% names(present)]"
"0","  out <- list()"
"0",""
"0","  for (s in items) {"
"0","    col <- present[[s]]"
"0","    if (!col %in% names(dat)) next"
"0",""
"0","    raw <- dat[[col]] |> clean_ans()"
"0","    raw[raw == """"] <- NA_character_"
"0","    raw <- raw[!is.na(raw)]"
"0","    if (!length(raw)) next"
"0",""
"0","    bucket <- map_chr(raw, map_bucket)"
"0","    bucket <- factor(bucket, levels = bucket_levels)"
"0","    bucket <- droplevels(bucket)"
"0","    bucket <- bucket[!is.na(bucket)]"
"0","    if (!length(bucket)) next"
"0",""
"0","    tab <- as.data.frame("
"0","      table(item = rep(pretty_label[[s]], length(bucket)),"
"0","            bucket = bucket,"
"0","            useNA = ""no""),"
"0","      stringsAsFactors = FALSE"
"0","    )"
"0","    total <- sum(tab$Freq)"
"0","    tab$pct <- if (total == 0) 0 else tab$Freq / total"
"0",""
"0","    out[[length(out) + 1]] <- tab[, c(""item"",""bucket"",""pct"")]"
"0","  }"
"0",""
"0","  if (!length(out)) tibble(item = character(), bucket = factor(levels = bucket_levels), pct = double())"
"0","  else bind_rows(out)"
"0","}"
"0",""
"0",""
"0","plot_panel <- function(df, title) {"
"0","  if (nrow(df) == 0) {"
"0","    message(""No data found for: "", title)"
"0","    return(ggplot() + labs(title = title, caption = ""No responses found."") + theme_void())"
"0","  }"
"0",""
"0","  used_levels <- df %>% distinct(bucket) %>% pull(bucket) %>% as.character()"
"0","  used_levels <- bucket_levels[bucket_levels %in% used_levels]"
"0","  pal <- bucket_colors[used_levels]"
"0",""
"0","  df$bucket <- factor(as.character(df$bucket), levels = used_levels)"
"0",""
"0","  ggplot(df, aes(x = factor(item, levels = rev(unique(item))), y = pct, fill = bucket)) +"
"0","    geom_col(width = 0.75, color = uo$gray_dark, linewidth = 0.25) +"
"0","    coord_flip() +"
"0","    scale_y_continuous(labels = percent_format(accuracy = 1), expand = c(0, 0), limits = c(0, 1)) +"
"0","    scale_fill_manual(values = pal, drop = TRUE, name = ""Response"") +"
"0","    labs("
"0","      title = title, x = NULL, y = NULL,"
"0","      caption = ""Each bar shows the response distribution for one item (100% stacked)."""
"0","    ) +"
"0","    theme_uo"
"0","}"
"0",""
"0",""
"0","instructional_items <- c("
"0","  ""recorded_lessons_clarity"","
"0","  ""guided_notes_helpful"","
"0","  ""recorded_prepared_quiz"","
"0","  ""one_pager_useful"","
"0","  ""live_coaching_understand"","
"0","  ""live_coaching_fluency"""
"0",")"
"0","impact_items <- c("
"0","  ""confidence_apply"","
"0","  ""used_pt_real_life"","
"0","  ""likely_use_pt"","
"0","  ""overall_satisfaction"","
"0","  ""recommend_workshop"""
"0",")"
"0",""
"0",""
"0","df_instructional <- panel_df(instructional_items)"
"0","df_impact        <- panel_df(impact_items)"
"0",""
"0","p_instructional <- plot_panel(df_instructional, ""Instructional Components"")"
"0","p_impact        <- plot_panel(df_impact,        ""Impact"")"
"0",""
"0","print(p_instructional)"
