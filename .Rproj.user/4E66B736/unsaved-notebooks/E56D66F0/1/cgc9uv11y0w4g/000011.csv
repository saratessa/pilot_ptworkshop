"0","library(tidyverse)"
"0",""
"0","# === Colors: keep your original yellow/green; Week 1 is gray ==="
"0","uo_yellow <- ""#FEE123""   # replace if you used a different yellow"
"0","uo_green  <- ""#00503C""   # replace if you used a different green"
"0","wk1_gray  <- ""grey70""    # Week 1 gray"
"0",""
"0","# === Read your updated CSV ==="
"0","# Update path if needed:"
"0","df <- readr::read_csv(""verbal_scores.csv"", show_col_types = FALSE)"
"0",""
"0","# --- Normalize to LONG format, preserving only Weeks 1, 3, 5 ---"
"0","name_lc <- tolower(names(df))"
"0",""
"0","is_long <- any(name_lc %in% c(""week"",""weeklabel"")) &&"
"0","           any(name_lc %in% c(""totalscore"",""score"",""value""))"
"0",""
"0","if (is_long) {"
"0","  week_col <- names(df)[name_lc %in% c(""week"",""weeklabel"")][1]"
"0","  score_col <- names(df)[name_lc %in% c(""totalscore"",""score"",""value"")][1]"
"0","  part_col  <- names(df)[name_lc %in% c(""participant"",""id"",""name"")][1]"
"0",""
"0","  long <- df |>"
"0","    rename("
"0","      Week        = all_of(week_col),"
"0","      TotalScore  = all_of(score_col),"
"0","      Participant = all_of(part_col)"
"0","    ) |>"
"0","    mutate("
"0","      Week = as.character(Week),"
"0","      Week = tolower(trimws(Week)),"
"0","      Week = dplyr::recode(Week,"
"0","        ""week 1"" = ""Week 1"", ""week1"" = ""Week 1"", ""w1"" = ""Week 1"", ""1"" = ""Week 1"","
"0","        ""week 3"" = ""Week 3"", ""week3"" = ""Week 3"", ""w3"" = ""Week 3"", ""3"" = ""Week 3"","
"0","        ""week 5"" = ""Week 5"", ""week5"" = ""Week 5"", ""w5"" = ""Week 5"", ""5"" = ""Week 5"""
"0","      )"
"0","    )"
"0","} else {"
"0","  # WIDE format expected: Participant, Week1, Week3, Week5 (any capitalization ok)"
"0","  part_col <- names(df)[name_lc %in% c(""participant"",""id"",""name"")][1]"
"0","  w1 <- names(df)[name_lc %in% c(""week1"",""w1"",""wk1"")][1]"
"0","  w3 <- names(df)[name_lc %in% c(""week3"",""w3"",""wk3"")][1]"
"0","  w5 <- names(df)[name_lc %in% c(""week5"",""w5"",""wk5"")][1]"
"0",""
"0","  long <- df |>"
"0","    rename(Participant = all_of(part_col)) |>"
"0","    pivot_longer("
"0","      cols = c(all_of(w1), all_of(w3), all_of(w5)),"
"0","      names_to = ""Week"","
"0","      values_to = ""TotalScore"""
"0","    ) |>"
"0","    mutate("
"0","      Week = tolower(Week),"
"0","      Week = dplyr::recode(Week,"
"0","        ""week1"" = ""Week 1"", ""w1"" = ""Week 1"", ""wk1"" = ""Week 1"","
"0","        ""week3"" = ""Week 3"", ""w3"" = ""Week 3"", ""wk3"" = ""Week 3"","
"0","        ""week5"" = ""Week 5"", ""w5"" = ""Week 5"", ""wk5"" = ""Week 5"""
"0","      )"
"0","    )"
"0","}"
"0",""
"0","# Keep exactly Weeks 1, 3, 5 in that order"
"0","long <- long |>"
"0","  filter(Week %in% c(""Week 1"",""Week 3"",""Week 5"")) |>"
"0","  mutate("
"0","    Week = factor(Week, levels = c(""Week 1"",""Week 3"",""Week 5"")),"
"0","    TotalScore = suppressWarnings(as.numeric(TotalScore))"
"0","  )"
"0",""
"0","# --- Build the plot: same style, just adds Week 1 as gray ---"
"0","y_min <- 0; y_max <- 21"
"0","p <- ggplot(long, aes(x = Participant, y = TotalScore, fill = Week)) +"
"0","  geom_col(position = position_dodge(width = 0.8), width = 0.7) +"
"0","  # Horizontal cut lines"
"0","  geom_hline(yintercept = 7,  linetype = ""dashed"") +"
"0","  geom_hline(yintercept = 11, linetype = ""dashed"") +"
"0","  geom_hline(yintercept = 17, linetype = ""dashed"") +"
"0","  # Right-side labels for ranges (allow margin for text)"
"0","  coord_cartesian(ylim = c(y_min, y_max), clip = ""off"") +"
"0","  annotate(""text"", x = Inf, y = 9,  label = ""Beginner (7–10)"",     hjust = 1.02, vjust = 0.5) +"
"0","  annotate(""text"", x = Inf, y = 13, label = ""Intermediate (11–16)"", hjust = 1.02, vjust = 0.5) +"
"0","  annotate(""text"", x = Inf, y = 19, label = ""Advanced (17–21)"",     hjust = 1.02, vjust = 0.5) +"
"0","  # Keep your original title/axes"
"0","  labs("
"0","    title = ""Verbal Description Scores (Week 3 vs Week 5)"","
"0","    x = ""Participant"","
"0","    y = ""Total Score (0–21 rubric)"""
"0","  ) +"
"0","  # Preserve your minimal look; adjust base_family if you used a specific font"
"0","  theme_minimal(base_size = 14) +"
"0","  theme("
"0","    legend.position = ""top"","
"0","    legend.title = element_text(face = ""bold""),"
"0","    plot.title.position = ""plot"","
"0","    axis.text.x = element_text(angle = 30, hjust = 1),"
"0","    plot.margin = margin(10, 30, 10, 10) # extra right space for labels"
"0","  ) +"
"0","  # EXACT legend order and colors: Week 1 (gray), Week 3 (yellow), Week 5 (green)"
"0","  scale_fill_manual("
"0","    name   = ""Week"","
"0","    breaks = c(""Week 1"",""Week 3"",""Week 5""),"
"0","    values = c(""Week 1"" = wk1_gray, ""Week 3"" = uo_yellow, ""Week 5"" = uo_green)"
"0","  )"
"0",""
"0","p"
"0",""
